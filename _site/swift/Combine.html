<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.0.0" /><meta property="og:title" content="Combine" /><meta property="og:locale" content="en_US" /><meta name="description" content="Basics of using Combine." /><meta property="og:description" content="Basics of using Combine." /><link rel="canonical" href="http://localhost:4000/swift/Combine" /><meta property="og:url" content="http://localhost:4000/swift/Combine" /><meta property="og:site_name" content="devai.b" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-20T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Combine" /><meta name="twitter:site" content="@Devaib" /><meta name="twitter:creator" content="@Devaib" /> <script type="application/ld+json"> {"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/swift/Combine"},"headline":"Combine","url":"http://localhost:4000/swift/Combine","description":"Basics of using Combine.","dateModified":"2021-02-20T00:00:00-05:00","datePublished":"2021-02-20T00:00:00-05:00","@context":"https://schema.org"}</script><title> Combine - devai.b</title><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="devai.b" href="/atom.xml"><link rel="alternate" type="application/json" title="devai.b" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui, sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:0.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:0.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">devai.b</h1>--><nav role="navigation"><ul><li><a href="/" >Writing</a></li><li><a href="/about" >About</a></li><li><a href="/search" >Search</a></li><li><a href="/atom.xml" >Rss</a></li></ul></nav></header><section class="post"><h2>Combine</h2><ul><li><a href="https://www.swiftbysundell.com/basics/combine/">Combine - Swift by Sundel</a></li><li><a href="https://gist.github.com/staltz/868e7e9bc2a7b8c1f754">The introduction to Reactive Programming youâ€™ve been missing</a></li></ul><p><img src="https://camo.githubusercontent.com/76ab7699f5cd046162eecb0732308eba84753a41fc0e8966f66a7654aecd5ec0/687474703a2f2f692e696d6775722e636f6d2f634c344d4f73532e706e67" alt="Reactive Programming - stream picutre" /></p><p>(A picture showing the concept of a <em>stream</em> in reactive programming)</p><h3 id="keynotes">Keynotes</h3><ul><li>A <em>publisher</em> is an observable object that emits values over time, and that can also optionally complete either when no more values are available, or when it encountered an error.</li><li>Objects or closures that are used to observe a publisher are referred to as <em>subscribers</em>.</li><li>A <em>subject</em> is a mutable object that can be used to send new values through a publisher. Types like <code class="highlighter-rouge">PassthroughSubject</code> act as both publishers and subjects.</li><li><em>Operators</em> are used to build reactive chains or pipelines that our data can flow through, where each operator applies some form of transform to the data that was sent to it.</li><li>A <em>cancellable</em> is used to keep track of a subscription to a given publisher, and needs to be retained for as long as we want that subscription to remain active.</li></ul><h3 id="example-of-using-combine-for-making-a-network-request">Example of using Combine for making a network request</h3><div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">struct</span> <span class="kt">Repository</span><span class="p">:</span> <span class="kt">Codable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">url</span><span class="p">:</span> <span class="kt">URL</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">nameLabel</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">errorLabel</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">()</span>

<span class="k">let</span> <span class="nv">url</span> <span class="o">=</span> <span class="kt">URL</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="s">"https://api.github.com/repos/johnsundell/publish"</span><span class="p">)</span><span class="o">!</span>
<span class="c1">// a publisher that emits `(Data, URLResponse)` values</span>
<span class="k">let</span> <span class="nv">publisher</span> <span class="o">=</span> <span class="kt">URLSession</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">dataTaskPublisher</span><span class="p">(</span><span class="nv">for</span><span class="p">:</span> <span class="n">url</span><span class="p">)</span>
<span class="c1">// a publisher that emits `Repository` values</span>
<span class="k">let</span> <span class="nv">repoPublier</span> <span class="o">=</span> <span class="n">publisher</span>
    <span class="c1">// transform network result values by extracting their `data` property</span>
    <span class="o">.</span><span class="nf">map</span><span class="p">(\</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="c1">// decode `data` and new publisher emits `Repository` values</span>
    <span class="o">.</span><span class="nf">decode</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="kt">Repository</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">decoder</span><span class="p">:</span> <span class="kt">JSONDecoder</span><span class="p">())</span>
    <span class="c1">// jump over from background to main thread</span>
    <span class="o">.</span><span class="nf">receive</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">cancellable</span> <span class="o">=</span> <span class="n">repoPublier</span><span class="o">.</span><span class="nf">sink</span><span class="p">(</span>
    <span class="nv">receiveCompletion</span><span class="p">:</span> <span class="p">{</span> <span class="n">completion</span> <span class="k">in</span>
        <span class="k">switch</span> <span class="n">completion</span> <span class="p">{</span>
        <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">errorLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">error</span><span class="o">.</span><span class="n">localizedDescription</span>
        <span class="k">case</span> <span class="o">.</span><span class="nv">finished</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Success"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nv">receiveValue</span><span class="p">:</span> <span class="p">{</span> <span class="n">repo</span> <span class="k">in</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">repo</span><span class="p">)</span>
        <span class="n">nameLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">name</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre></div></div><h3 id="example-of-creating-our-own-publisher">Example of creating our own publisher</h3><div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">Combine</span>

<span class="kd">class</span> <span class="kt">Counter</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">subject</span> <span class="o">=</span> <span class="kt">PassthroughSubject</span><span class="o">&lt;</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Never</span><span class="o">&gt;</span><span class="p">()</span>
    <span class="k">var</span> <span class="nv">publisher</span><span class="p">:</span> <span class="kt">AnyPublisher</span><span class="o">&lt;</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Never</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="n">subject</span><span class="o">.</span><span class="nf">eraseToAnyPublisher</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="kd">private(set)</span> <span class="k">var</span> <span class="nv">value</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span> <span class="n">subject</span><span class="o">.</span><span class="nf">send</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">func</span> <span class="nf">increment</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">counter</span> <span class="o">=</span> <span class="kt">Counter</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">cancellable1</span> <span class="o">=</span> <span class="n">counter</span><span class="o">.</span><span class="n">publisher</span>
    <span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="p">}</span>
    <span class="o">.</span><span class="n">sink</span> <span class="p">{</span> <span class="n">value</span> <span class="k">in</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="p">}</span>

<span class="n">counter</span><span class="o">.</span><span class="nf">increment</span><span class="p">()</span>
<span class="n">counter</span><span class="o">.</span><span class="nf">increment</span><span class="p">()</span>
<span class="n">counter</span><span class="o">.</span><span class="nf">increment</span><span class="p">()</span>
</code></pre></div></div><span class="meta"><time datetime="2021-02-20T00:00:00-05:00">February 20, 2021</time> &middot; <a href="/tag/swift">swift</a>, <a href="/tag/combine">combine</a>, <a href="/tag/reactiveprogramming">reactiveprogramming</a></span></section></main></body></html>
